import{d as Ve,r as g,o as _e,c as n,a as r,e,f as y,g as Le,w as He,n as l,h as Re,t as c,F as E,k as M,a5 as h,a6 as A,a7 as We,a8 as Oe,s as C,u as d,a9 as Ye,p as Ke,b as i,j as Je}from"./index-Cb9bHEfA.js";import{u as qe}from"./useProjectHub-BU6P98o1.js";import{u as Ge}from"./useTheme-g-avcNHO.js";import{_ as Qe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./apiClient-C3SqeptG.js";const Xe={class:"header-content"},Ze={class:"header-actions"},et=["onClick"],tt={class:"day-number"},at={key:1,class:"events-list"},st={class:"event-content"},lt={class:"event-title"},nt={class:"event-actions"},ot=["onClick"],rt={key:2,class:"todo-items"},it={class:"todo-checkbox"},ut=["checked","onChange"],ct=["onClick"],dt={class:"form-group"},vt={class:"form-group"},pt={class:"form-group"},mt={class:"form-group"},yt=Ve({__name:"CalendarPage",setup(gt){const{theme:s}=Ge(),{tasks:b,events:H,isLoading:R,completedTasks:j,fetchTasks:w,createTask:W,toggleTaskComplete:O,deleteTask:Y,fetchProjectEvents:I}=qe({taskCalendar:"tasks",eventCalendar:"personal"}),v=g(new Date),p=g(null),m=g("incomplete"),x=g(!1),u=g({title:"",description:"",startDate:"",allDay:!1}),S=g(""),T=g(0);_e(async()=>{await Promise.all([w(),I(90)])});const K=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],J=n(()=>v.value.toLocaleDateString("en-US",{month:"long",year:"numeric"})),q=n(()=>{const o=v.value.getFullYear(),a=v.value.getMonth(),f=new Date(o,a,1),t=new Date(f);t.setDate(t.getDate()-f.getDay());const k=[],D=new Date(t);for(let L=0;L<42;L++){const Fe=D.toISOString().slice(0,10),Ne=H.value.filter(Ue=>Ue.startDate.slice(0,10)===Fe);k.push({date:new Date(D),events:Ne,isCurrentMonth:D.getMonth()===a}),D.setDate(D.getDate()+1)}return k}),F=o=>o.toDateString()===new Date().toDateString(),G=o=>{p.value=o},Q=()=>{v.value=new Date(v.value.getFullYear(),v.value.getMonth()-1)},X=()=>{v.value=new Date(v.value.getFullYear(),v.value.getMonth()+1)},Z=o=>o.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"}),ee=o=>{try{return new Date(o).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}catch{return o}},te=o=>{try{return new Date(o).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch{return o}};async function ae(){if(!(!u.value.title||!u.value.startDate))try{const o="/cmd-api",a={title:u.value.title,description:u.value.description||void 0,allDay:u.value.allDay};u.value.allDay?a.startDate=u.value.startDate.slice(0,10):a.startDate=new Date(u.value.startDate).toISOString(),await fetch(`${o}/calendar-events`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)}),await I(90),x.value=!1,u.value={title:"",description:"",startDate:"",allDay:!1}}catch(o){console.error("Failed to create event:",o)}}async function se(o){if(confirm("Delete this event?"))try{await fetch(`/cmd-api/calendar-events/${o}`,{method:"DELETE",headers:{"Content-Type":"application/json"}}),await I(90),p.value&&(p.value={...p.value,events:p.value.events.filter(f=>f.id!==o)})}catch(a){console.error("Failed to delete event:",a)}}async function N(){S.value.trim()&&(await W({summary:S.value.trim(),priority:T.value||void 0}),S.value="",T.value=0)}async function le(o){confirm("Delete this task?")&&await Y(o)}const ne=n(()=>({minHeight:"100vh",padding:"2rem",background:s.value.backgrounds.app,color:s.value.text.primary})),oe=n(()=>({marginBottom:"2rem",padding:"1.5rem",background:s.value.backgrounds.card,borderRadius:"8px",border:`4px solid ${s.value.primary.ramp3}`})),re=n(()=>({fontSize:"2rem",color:s.value.primary.ramp5,textShadow:`0 0 10px ${s.value.effects.glow}`})),ie=n(()=>({background:s.value.secondary.ramp3,color:s.value.text.primary,border:`4px solid ${s.value.secondary.ramp4}`})),$=n(()=>({borderColor:s.value.primary.ramp4,color:s.value.text.primary})),ue=n(()=>({display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(500px, 1fr))",gap:"2rem"})),U=n(()=>({background:s.value.backgrounds.card,border:`4px solid ${s.value.primary.ramp3}`,padding:"1.5rem"})),ce=n(()=>({display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"1rem"})),V=n(()=>({background:s.value.accent.ramp3,borderColor:s.value.accent.ramp4})),de=n(()=>({color:s.value.primary.ramp5,fontSize:"1.5rem"})),ve=n(()=>({display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"4px",marginTop:"1rem"})),pe=n(()=>({textAlign:"center",padding:"0.5rem",fontWeight:"bold",color:s.value.accent.ramp5,background:s.value.backgrounds.surface})),me=o=>{const a={padding:"0.75rem",textAlign:"center",cursor:"pointer",background:o.isCurrentMonth?s.value.backgrounds.surface:s.value.backgrounds.app,border:`2px solid ${s.value.neutral.ramp3}`,minHeight:"60px",position:"relative",transition:"all 0.2s"};return F(o.date)?{...a,border:`3px solid ${s.value.status.info}`,background:s.value.primary.ramp1,fontWeight:"bold"}:o.events.length>0?{...a,background:s.value.accent.ramp1}:a},ye=n(()=>({position:"absolute",top:"4px",right:"4px",background:s.value.status.success,color:s.value.text.primary,borderRadius:"50%",width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",fontWeight:"bold"})),ge=n(()=>({marginTop:"2rem",padding:"1rem",background:s.value.backgrounds.surface,borderRadius:"4px"})),be=n(()=>({color:s.value.primary.ramp5,marginBottom:"1rem"})),P=n(()=>({color:s.value.text.muted,fontStyle:"italic",textAlign:"center",padding:"2rem"})),fe=n(()=>({background:s.value.backgrounds.elevated,border:`2px solid ${s.value.primary.ramp3}`,padding:"1rem",marginBottom:"0.5rem",display:"flex",justifyContent:"space-between",alignItems:"center"})),ke=n(()=>({color:s.value.accent.ramp5,fontSize:"0.9rem",marginTop:"0.25rem"})),he=n(()=>({color:s.value.text.secondary,fontSize:"0.9rem",marginTop:"0.5rem"})),xe=n(()=>({display:"flex",gap:"0.5rem",marginBottom:"1rem"})),B=n(()=>({background:s.value.backgrounds.surface,color:s.value.text.primary,borderColor:s.value.primary.ramp3})),Se=n(()=>({background:s.value.backgrounds.surface,color:s.value.text.primary,borderColor:s.value.primary.ramp3})),De=n(()=>({display:"flex",gap:"0.25rem",marginBottom:"0.75rem"})),z=n(()=>({fontSize:"0.7rem",padding:"0.25rem 0.5rem"})),Ce=o=>({display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.75rem",background:s.value.backgrounds.elevated,border:`2px solid ${s.value.neutral.ramp3}`,borderRadius:"4px",marginBottom:"0.5rem",opacity:o.status==="completed"?.6:1}),we=n(()=>({display:"flex",gap:"0.5rem",alignItems:"center"})),Te=n(()=>({fontSize:"0.7rem",color:s.value.text.muted})),$e=n(()=>({fontSize:"0.65rem",color:s.value.accent.ramp5,padding:"0.1rem 0.3rem",background:"rgba(255,255,255,0.05)",borderRadius:"2px"})),_=o=>({background:{high:s.value.status.error,medium:s.value.status.warning,low:s.value.status.success}[o],color:s.value.text.primary,padding:"0.25rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:"bold",textTransform:"uppercase"}),Be=n(()=>({display:"flex",alignItems:"center",gap:"0.75rem",marginTop:"1rem",paddingTop:"0.75rem",borderTop:`1px solid ${s.value.primary.ramp3}40`})),Ee=n(()=>({flex:"1",height:"6px",background:"rgba(0,0,0,0.3)",borderRadius:"3px",overflow:"hidden"})),Me=()=>({width:`${b.value.length>0?j.value.length/b.value.length*100:0}%`,height:"100%",background:s.value.status.success,transition:"width 0.3s ease"}),Ae=n(()=>({fontSize:"0.75rem",color:s.value.text.muted,whiteSpace:"nowrap"})),Ie=n(()=>({position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.8)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3})),Pe=n(()=>({background:s.value.backgrounds.card,border:`4px solid ${s.value.primary.ramp4}`,maxWidth:"600px",width:"90%",maxHeight:"80vh",overflow:"auto"})),ze=n(()=>({padding:"1rem"})),je=n(()=>({display:"flex",gap:"1rem",justifyContent:"flex-end",marginTop:"1.5rem"}));return(o,a)=>{const f=Re("router-link");return i(),r("div",{class:"calendar-page",style:l(ne.value)},[e("header",{class:"calendar-header",style:l(oe.value)},[e("div",Xe,[Le(f,{to:"/",class:"nes-btn back-button",style:l(ie.value)},{default:He(()=>[...a[13]||(a[13]=[Je(" â† Back to Dashboard ",-1)])]),_:1},8,["style"]),e("h1",{class:"nes-text is-primary",style:l(re.value)}," ðŸ“… Calendar & Tasks ",4),e("div",Ze,[e("button",{class:"nes-btn is-success",style:l($.value),onClick:a[0]||(a[0]=t=>x.value=!0)}," + Event ",4)])])],4),e("div",{class:"calendar-content",style:l(ue.value)},[e("section",{class:"calendar-section nes-container with-title is-dark",style:l(U.value)},[a[14]||(a[14]=e("p",{class:"title"},"Monthly Calendar",-1)),e("div",{class:"month-navigation",style:l(ce.value)},[e("button",{class:"nes-btn",style:l(V.value),onClick:Q},"â—€",4),e("h2",{class:"nes-text",style:l(de.value)},c(J.value),5),e("button",{class:"nes-btn",style:l(V.value),onClick:X},"â–¶",4)],4),e("div",{class:"calendar-grid",style:l(ve.value)},[(i(),r(E,null,M(K,t=>e("div",{key:t,class:"day-header",style:l(pe.value)},c(t),5)),64)),(i(!0),r(E,null,M(q.value,t=>(i(),r("div",{key:`${t.date.toISOString()}`,class:C(["calendar-day",{"is-today":F(t.date),"is-other-month":!t.isCurrentMonth,"has-events":t.events.length>0}]),style:l(me(t)),onClick:k=>G(t)},[e("div",tt,c(t.date.getDate()),1),t.events.length>0?(i(),r("div",{key:0,class:"event-indicator",style:l(ye.value)},c(t.events.length),5)):y("",!0)],14,et))),128))],4),p.value?(i(),r("div",{key:0,class:"day-events",style:l(ge.value)},[e("h3",{class:"nes-text",style:l(be.value)}," Events for "+c(Z(p.value.date)),5),p.value.events.length===0?(i(),r("div",{key:0,class:"no-events",style:l(P.value)}," No events scheduled ",4)):(i(),r("div",at,[(i(!0),r(E,null,M(p.value.events,t=>(i(),r("div",{key:t.id,class:"event-item nes-container is-dark",style:l(fe.value)},[e("div",st,[e("div",lt,c(t.title),1),e("div",{class:"event-time",style:l(ke.value)},c(t.allDay?"All Day":ee(t.startDate)),5),t.description?(i(),r("div",{key:0,class:"event-description",style:l(he.value)},c(t.description),5)):y("",!0)]),e("div",nt,[e("button",{class:"nes-btn is-error is-small",onClick:k=>se(t.id)}," Delete ",8,ot)])],4))),128))]))],4)):y("",!0)],4),e("section",{class:"todos-section nes-container with-title is-dark",style:l(U.value)},[a[16]||(a[16]=e("p",{class:"title"},"Tasks",-1)),e("div",{class:"todos-header",style:l(xe.value)},[h(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>S.value=t),type:"text",class:"nes-input",placeholder:"New task...",style:l(B.value),onKeyup:We(N,["enter"])},null,36),[[A,S.value]]),h(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>T.value=t),class:"nes-select",style:l(Se.value)},[...a[15]||(a[15]=[e("option",{value:0},"No priority",-1),e("option",{value:1},"High",-1),e("option",{value:5},"Medium",-1),e("option",{value:9},"Low",-1)])],4),[[Oe,T.value]]),e("button",{class:"nes-btn is-primary",style:l($.value),onClick:N}," + Add ",4)],4),e("div",{style:l(De.value)},[e("button",{class:C(["nes-btn",m.value==="incomplete"?"is-warning":""]),style:l(z.value),onClick:a[3]||(a[3]=t=>{m.value="incomplete",d(w)(m.value)})},"Active",6),e("button",{class:C(["nes-btn",m.value==="completed"?"is-success":""]),style:l(z.value),onClick:a[4]||(a[4]=t=>{m.value="completed",d(w)(m.value)})},"Done",6),e("button",{class:C(["nes-btn",m.value==="all"?"is-primary":""]),style:l(z.value),onClick:a[5]||(a[5]=t=>{m.value="all",d(w)(m.value)})},"All",6)],4),d(R)?(i(),r("div",{key:0,style:l(P.value)},"Loading tasks...",4)):d(b).length===0?(i(),r("div",{key:1,style:l(P.value)}," No tasks yet. Add one above. ",4)):(i(),r("div",rt,[(i(!0),r(E,null,M(d(b),t=>(i(),r("div",{key:t.id,class:"todo-item",style:l(Ce(t))},[e("label",it,[e("input",{type:"checkbox",class:"nes-checkbox",checked:t.status==="completed",onChange:k=>d(O)(t.id)},null,40,ut),e("span",{class:C({completed:t.status==="completed"})},c(t.summary),3)]),e("div",{class:"todo-meta",style:l(we.value)},[t.priority>=1&&t.priority<=3?(i(),r("span",{key:0,class:"priority-badge",style:l(_("high"))}," P"+c(t.priority),5)):t.priority>=4&&t.priority<=6?(i(),r("span",{key:1,class:"priority-badge",style:l(_("medium"))}," P"+c(t.priority),5)):y("",!0),t.due?(i(),r("span",{key:2,style:l(Te.value)},c(te(t.due)),5)):y("",!0),t.categories.length>0?(i(),r("span",{key:3,style:l($e.value)},c(t.categories.join(", ")),5)):y("",!0),e("button",{class:"nes-btn is-error is-small",onClick:k=>le(t.id)}," Ã— ",8,ct)],4)],4))),128))])),d(b).length>0?(i(),r("div",{key:3,style:l(Be.value)},[e("div",{style:l(Ee.value)},[e("div",{style:l(Me())},null,4)],4),e("span",{style:l(Ae.value)},c(d(j).length)+"/"+c(d(b).length)+" completed",5)],4)):y("",!0)],4)],4),x.value?(i(),r("div",{key:0,class:"dialog-overlay",style:l(Ie.value),onClick:a[12]||(a[12]=t=>x.value=!1)},[e("div",{class:"dialog nes-container is-dark with-title",style:l(Pe.value),onClick:a[11]||(a[11]=Ke(()=>{},["stop"]))},[a[21]||(a[21]=e("p",{class:"title"},"Create New Event",-1)),e("div",{class:"dialog-content",style:l(ze.value)},[e("div",dt,[a[17]||(a[17]=e("label",{class:"nes-text"},"Title:",-1)),h(e("input",{"onUpdate:modelValue":a[6]||(a[6]=t=>u.value.title=t),type:"text",class:"nes-input",style:l(B.value)},null,4),[[A,u.value.title]])]),e("div",vt,[a[18]||(a[18]=e("label",{class:"nes-text"},"Description:",-1)),h(e("textarea",{"onUpdate:modelValue":a[7]||(a[7]=t=>u.value.description=t),class:"nes-textarea",style:l(B.value)},null,4),[[A,u.value.description]])]),e("div",pt,[a[19]||(a[19]=e("label",{class:"nes-text"},"Start Date:",-1)),h(e("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>u.value.startDate=t),type:"datetime-local",class:"nes-input",style:l(B.value)},null,4),[[A,u.value.startDate]])]),e("div",mt,[e("label",null,[h(e("input",{"onUpdate:modelValue":a[9]||(a[9]=t=>u.value.allDay=t),type:"checkbox",class:"nes-checkbox"},null,512),[[Ye,u.value.allDay]]),a[20]||(a[20]=e("span",{class:"nes-text"},"All Day Event",-1))])]),e("div",{class:"dialog-actions",style:l(je.value)},[e("button",{class:"nes-btn is-success",style:l($.value),onClick:ae}," Create Event ",4),e("button",{class:"nes-btn",style:l($.value),onClick:a[10]||(a[10]=t=>x.value=!1)}," Cancel ",4)],4)],4)],4)],4)):y("",!0)],4)}}}),Dt=Qe(yt,[["__scopeId","data-v-a0e17f1d"]]);export{Dt as default};
