import{r as y,c as r,d as Ie,q as Ne,o as Ue,l as De,w as me,e,n as a,g as Ee,h as Pe,t as u,a as i,k as j,s as _e,F as A,f as g,u as s,j as G,a5 as h,a6 as b,a7 as ye,a8 as He,b as o}from"./index-jn2-hf1V.js";import{S as je}from"./SeasonalThemeProvider-DDXAvB9e.js";import{_ as Ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useTheme-BetD5DwV.js";import"./AtmosphericBackground-CLc6k5PS.js";import"./ScanlineOverlay-DvoZWnBY.js";const Ge="/cmd-api";function Oe(w={}){return{"Content-Type":"application/json",...w}}async function L(w,x={}){const C=`${Ge}${w}`,l=await fetch(C,{...x,headers:Oe(x.headers||{})});if(!l.ok&&l.status!==201){const v=await l.json().catch(()=>({error:l.statusText}));throw new Error(v.error||`API error ${l.status}`)}return l.json()}function qe(){const w=y([]),x=y([]),C=y(null),l=y(!1),v=y(null);async function k(){v.value=null;try{C.value=await L("/health/summary")}catch(c){v.value=c.message}}async function f(c){l.value=!0,v.value=null;try{const d=c?`?days=${c}`:"",E=await L(`/health/weight${d}`);w.value=E.entries||[]}catch(d){v.value=d.message}finally{l.value=!1}}async function R(c){l.value=!0,v.value=null;try{const d=c?`?days=${c}`:"",E=await L(`/health/rowing${d}`);x.value=E.entries||[]}catch(d){v.value=d.message}finally{l.value=!1}}async function V(c){v.value=null;try{await L("/health/weight",{method:"POST",body:JSON.stringify(c)}),await f(90),await k()}catch(d){throw v.value=d.message,d}}async function I(c){v.value=null;try{await L("/health/rowing",{method:"POST",body:JSON.stringify(c)}),await R(90),await k()}catch(d){throw v.value=d.message,d}}async function N(c){v.value=null;try{await L(`/health/weight/${c}`,{method:"DELETE"}),w.value=w.value.filter(d=>d.id!==c),await k()}catch(d){v.value=d.message}}async function T(c){v.value=null;try{await L(`/health/rowing/${c}`,{method:"DELETE"}),x.value=x.value.filter(d=>d.id!==c),await k()}catch(d){v.value=d.message}}async function W(){l.value=!0;try{await Promise.all([k(),f(90),R(90)])}finally{l.value=!1}}const U=r(()=>[...w.value].reverse().slice(-30)),B=3,M=r(()=>{var c;return((c=C.value)==null?void 0:c.rowingThisWeek.sessions)||0}),D=r(()=>M.value>=B);return{weightEntries:w,rowingSessions:x,summary:C,isLoading:l,error:v,weightTrend:U,rowingStreakThisWeek:M,rowingOnTrack:D,weeklyRowingGoal:B,init:W,fetchSummary:k,fetchWeight:f,fetchRowing:R,addWeight:V,addRowing:I,deleteWeight:N,deleteRowing:T}}const Xe={style:{flex:"1"}},Ke=["onClick"],Je={class:"tab-emoji"},Qe={class:"tab-label"},Ye={key:2},Ze=["title"],et={key:3},tt=["disabled"],lt=["onClick"],at={key:4},nt=["disabled"],st=["onClick"],p="#2d7d46",K="#c4a747",S="#1a2a2a",ot=Ie({__name:"HealthPage",setup(w){var ne;const x=((ne=document.querySelector('link[rel="icon"]'))==null?void 0:ne.getAttribute("href"))||"";function C(m){const n=document.querySelector('link[rel="icon"]');n&&(n.href=`data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${m}</text></svg>`)}C("ðŸ‹ï¸"),Ne(()=>{const m=document.querySelector('link[rel="icon"]');m&&(m.href=x)});const l=qe(),v=y("dashboard"),k=[{id:"dashboard",label:"Dashboard",icon:"ðŸ“Š"},{id:"weight",label:"Weight",icon:"âš–ï¸"},{id:"rowing",label:"Rowing",icon:"ðŸš£"}],f=y(null),R=y("lbs"),V=y(null),I=y(""),N=y(""),T=y(null),W=y(null),U=y(""),B=y(null),M=y(null),D=y(""),c=r(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}));Ue(()=>l.init());async function d(){f.value&&(await l.addWeight({weight:f.value,unit:R.value,date:I.value||void 0,bodyFat:V.value||void 0,notes:N.value||void 0}),f.value=null,V.value=null,I.value="",N.value="")}async function E(){!T.value&&!W.value||(await l.addRowing({meters:T.value||void 0,minutes:W.value||void 0,date:D.value||void 0,splitPace:U.value||void 0,strokeRate:B.value||void 0,calories:M.value||void 0}),T.value=null,W.value=null,U.value="",B.value=null,M.value=null,D.value="")}const J=r(()=>{const m=l.weightTrend.value.map(n=>n.weight);return m.length?Math.min(...m)-2:0}),ge=r(()=>{const m=l.weightTrend.value.map(n=>n.weight);return m.length?Math.max(...m)+2:100}),pe=r(()=>({minHeight:"100vh",padding:"0",margin:"0",position:"relative",zIndex:"2"})),he=r(()=>({display:"flex",alignItems:"center",gap:"var(--space-md)",padding:"var(--space-md) var(--space-lg)",background:`linear-gradient(135deg, ${S}, ${S}dd)`,borderBottom:`4px solid ${p}`,position:"sticky",top:"0",zIndex:"50",backdropFilter:"blur(8px)"})),we=r(()=>({fontSize:"1.1rem",fontWeight:"700",color:K,margin:"0",letterSpacing:"1px"})),fe=r(()=>({fontSize:"0.6rem",color:`${K}99`,marginTop:"0.15rem"})),be=r(()=>({display:"flex",gap:"0.25rem",padding:"0.5rem var(--space-lg)",background:`${S}ee`,borderBottom:`2px solid ${p}66`,overflowX:"auto",backdropFilter:"blur(8px)"})),xe=r(()=>({fontSize:"0.6rem",padding:"0.35rem 0.7rem",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"0.3rem"})),Se=r(()=>({padding:"var(--space-lg)",maxWidth:"900px",margin:"0 auto"})),ke=r(()=>({background:"rgba(239, 68, 68, 0.15)",border:"2px solid rgba(239, 68, 68, 0.5)",borderRadius:"4px",padding:"0.5rem 0.75rem",marginBottom:"1rem",color:"#ff6b6b",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.75rem"})),O=r(()=>({textAlign:"center",padding:"2rem",color:"var(--text-muted)",fontSize:"0.85rem"})),Te={fontSize:"0.75rem",color:"var(--text-muted)"},$=r(()=>({background:`${S}cc`,border:`2px solid ${p}55`,borderRadius:"4px",padding:"0.75rem",marginBottom:"0.75rem",backdropFilter:"blur(4px)"})),z=r(()=>({fontSize:"0.75rem",color:K,margin:"0 0 0.5rem 0",fontWeight:"600",letterSpacing:"0.5px",textTransform:"uppercase"})),We=r(()=>({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"0.75rem",marginBottom:"0.75rem"})),q={fontSize:"1.8rem",fontWeight:"700",color:"var(--text-bright)",lineHeight:"1.2"},X={fontSize:"0.7rem",color:"var(--text-muted)",fontWeight:"400"},P={fontSize:"0.6rem",color:"var(--text-muted)",marginTop:"0.25rem"},$e=r(()=>({height:"12px",background:S,border:`2px solid ${p}44`,borderRadius:"2px",overflow:"hidden",marginTop:"0.4rem"})),ze=m=>({height:"100%",width:`${Math.min(100,Math.max(0,m))}%`,background:m>=100?"#22c55e":`linear-gradient(90deg, ${p}, ${p}cc)`,transition:"width 0.3s ease"}),Ce=r(()=>({display:"flex",alignItems:"flex-end",gap:"2px",height:"80px",padding:"0.25rem 0"}));function Re(m,n){return{flex:"1",display:"flex",flexDirection:"column",justifyContent:"flex-end",height:"100%"}}function Be(m){const n=ge.value-J.value;return{height:`${n>0?(m-J.value)/n*100:50}%`,background:p,borderRadius:"1px 1px 0 0",minHeight:"2px",transition:"height 0.3s ease"}}const Me=r(()=>({display:"flex",justifyContent:"space-between",marginTop:"0.15rem"})),Q=r(()=>({display:"flex",gap:"0.4rem",flexWrap:"wrap",alignItems:"center"})),Fe=r(()=>({flex:"1",minWidth:"120px",fontSize:"0.75rem",padding:"0.4rem",background:S,color:"var(--text-bright)",border:`2px solid ${p}66`})),F=r(()=>({width:"100px",fontSize:"0.75rem",padding:"0.4rem",background:S,color:"var(--text-bright)",border:`2px solid ${p}66`})),Y=r(()=>({width:"70px",fontSize:"0.65rem",padding:"0.25rem",background:S,color:"var(--text-bright)",border:`1px solid ${p}66`})),Le=r(()=>({fontSize:"0.65rem",padding:"0.35rem",width:"auto",background:S,color:"var(--text-bright)",border:`2px solid ${p}66`})),Z=r(()=>({fontSize:"0.65rem",padding:"0.35rem 0.7rem",whiteSpace:"nowrap"})),ee=r(()=>({display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.35rem 0",borderBottom:`1px solid ${p}22`,fontSize:"0.7rem"})),te={color:"var(--text-muted)",minWidth:"5rem",fontFamily:"monospace",fontSize:"0.6rem"},le={fontWeight:"700",color:"var(--text-bright)",fontSize:"0.8rem"},_={color:"var(--text-muted)",fontSize:"0.6rem"},Ve={flex:"1",color:"var(--text-muted)",fontSize:"0.6rem",fontStyle:"italic"},ae={padding:"0.1rem 0.35rem",fontSize:"0.55rem",flexShrink:"0"};return(m,n)=>{const se=Pe("router-link");return o(),De(je,{"enable-scanlines":!0,"enable-particles":!1,"enable-animations":!0},{default:me(()=>{var oe,ie,re,ue,de,ve,ce;return[e("div",{style:a(pe.value)},[e("header",{style:a(he.value)},[Ee(se,{to:"/",style:{"text-decoration":"none",color:"inherit",display:"flex","align-items":"center",gap:"0.5rem"}},{default:me(()=>[...n[12]||(n[12]=[e("span",{style:{"font-size":"1.5rem"}},"ðŸ‹ï¸",-1)])]),_:1}),e("div",Xe,[e("h1",{class:"nes-text",style:a(we.value)},"Health Tracker",4),e("div",{style:a(fe.value)},u(c.value),5)])],4),e("div",{style:a(be.value)},[(o(),i(A,null,j(k,t=>e("button",{key:t.id,class:_e(["nes-btn",v.value===t.id?"is-primary":""]),style:a(xe.value),onClick:H=>v.value=t.id},[e("span",Je,u(t.icon),1),e("span",Qe,u(t.label),1)],14,Ke)),64))],4),e("main",{style:a(Se.value)},[s(l).error.value?(o(),i("div",{key:0,style:a(ke.value)},[G(u(s(l).error.value)+" ",1),e("button",{class:"nes-btn is-error",style:{"margin-left":"1rem","font-size":"0.6rem"},onClick:n[0]||(n[0]=t=>s(l).error.value=null)},"X")],4)):g("",!0),s(l).isLoading.value&&!s(l).summary.value?(o(),i("div",{key:1,style:a(O.value)},[...n[13]||(n[13]=[e("p",{class:"nes-text"},"Loading health data...",-1)])],4)):v.value==="dashboard"?(o(),i("section",Ye,[e("div",{style:a(We.value)},[e("div",{style:a($.value)},[e("h3",{style:a(z.value)},"Weight",4),(oe=s(l).summary.value)!=null&&oe.latestWeight?(o(),i("div",{key:0,style:q},[G(u(s(l).summary.value.latestWeight.weight)+" ",1),e("span",{style:X},u(s(l).summary.value.latestWeight.unit),1)])):(o(),i("div",{key:1,style:Te},"No entries yet")),(ie=s(l).summary.value)!=null&&ie.latestWeight?(o(),i("div",{key:2,style:P},u(s(l).summary.value.latestWeight.date),1)):g("",!0)],4),e("div",{style:a($.value)},[e("h3",{style:a(z.value)},"Rowing This Week",4),e("div",{style:q},[G(u(s(l).rowingStreakThisWeek.value)+" ",1),e("span",{style:X},"/ "+u(s(l).weeklyRowingGoal)+" sessions",1)]),e("div",{style:a($e.value)},[e("div",{style:a(ze(Math.round(s(l).rowingStreakThisWeek.value/s(l).weeklyRowingGoal*100)))},null,4)],4),(re=s(l).summary.value)!=null&&re.rowingThisWeek?(o(),i("div",{key:0,style:P},u((s(l).summary.value.rowingThisWeek.totalMeters/1e3).toFixed(1))+"km total ",1)):g("",!0)],4),e("div",{style:a($.value)},[e("h3",{style:a(z.value)},"Rowing This Month",4),(ue=s(l).summary.value)!=null&&ue.rowingThisMonth?(o(),i("div",{key:0,style:q},[G(u(s(l).summary.value.rowingThisMonth.sessions)+" ",1),e("span",{style:X},"sessions")])):g("",!0),(de=s(l).summary.value)!=null&&de.rowingThisMonth?(o(),i("div",{key:1,style:P},u((s(l).summary.value.rowingThisMonth.totalMeters/1e3).toFixed(1))+"km total ",1)):g("",!0)],4)],4),s(l).weightTrend.value.length>1?(o(),i("div",{key:0,style:a($.value)},[e("h3",{style:a(z.value)},"Weight Trend (Last 30)",4),e("div",{style:a(Ce.value)},[(o(!0),i(A,null,j(s(l).weightTrend.value,(t,H)=>(o(),i("div",{key:t.id||H,style:a(Re(t.weight,H)),title:`${t.date}: ${t.weight} ${t.unit}`},[e("div",{style:a(Be(t.weight))},null,4)],12,Ze))),128))],4),e("div",{style:a(Me.value)},[e("span",{style:P},u((ve=s(l).weightTrend.value[0])==null?void 0:ve.date),1),e("span",{style:P},u((ce=s(l).weightTrend.value[s(l).weightTrend.value.length-1])==null?void 0:ce.date),1)],4)],4)):g("",!0)])):v.value==="weight"?(o(),i("section",et,[e("div",{style:a($.value)},[e("h3",{style:a(z.value)},"Log Weight",4),e("div",{style:a(Q.value)},[h(e("input",{"onUpdate:modelValue":n[1]||(n[1]=t=>f.value=t),type:"number",step:"0.1",placeholder:"Weight",class:"nes-input",style:a(F.value),onKeyup:ye(d,["enter"])},null,36),[[b,f.value,void 0,{number:!0}]]),h(e("select",{"onUpdate:modelValue":n[2]||(n[2]=t=>R.value=t),class:"nes-select",style:a(Le.value)},[...n[14]||(n[14]=[e("option",{value:"lbs"},"lbs",-1),e("option",{value:"kg"},"kg",-1)])],4),[[He,R.value]]),h(e("input",{"onUpdate:modelValue":n[3]||(n[3]=t=>V.value=t),type:"number",step:"0.1",placeholder:"Body fat %",class:"nes-input",style:a(F.value)},null,4),[[b,V.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":n[4]||(n[4]=t=>I.value=t),type:"date",class:"nes-input",style:a(F.value)},null,4),[[b,I.value]]),h(e("input",{"onUpdate:modelValue":n[5]||(n[5]=t=>N.value=t),placeholder:"Notes",class:"nes-input",style:a(Fe.value)},null,4),[[b,N.value]]),e("button",{class:"nes-btn is-success",style:a(Z.value),onClick:d,disabled:!f.value},"Log",12,tt)],4)],4),s(l).weightEntries.value.length>0?(o(),i("div",{key:0,style:a($.value)},[e("h3",{style:a(z.value)},"History",4),(o(!0),i(A,null,j(s(l).weightEntries.value,t=>(o(),i("div",{key:t.id,style:a(ee.value)},[e("span",{style:te},u(t.date),1),e("span",{style:le},u(t.weight)+" "+u(t.unit),1),t.bodyFat?(o(),i("span",{key:0,style:_},u(t.bodyFat)+"% BF",1)):g("",!0),t.notes?(o(),i("span",{key:1,style:Ve},u(t.notes),1)):g("",!0),e("button",{class:"nes-btn is-error",style:ae,onClick:H=>s(l).deleteWeight(t.id)},"X",8,lt)],4))),128))],4)):(o(),i("div",{key:1,style:a(O.value)},[...n[15]||(n[15]=[e("p",{class:"nes-text"},"No weight entries. Log your first one above.",-1)])],4))])):v.value==="rowing"?(o(),i("section",at,[e("div",{style:a($.value)},[e("h3",{style:a(z.value)},"Log Rowing Session",4),e("div",{style:a(Q.value)},[h(e("input",{"onUpdate:modelValue":n[6]||(n[6]=t=>T.value=t),type:"number",placeholder:"Meters",class:"nes-input",style:a(F.value),onKeyup:ye(E,["enter"])},null,36),[[b,T.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":n[7]||(n[7]=t=>W.value=t),type:"number",step:"0.1",placeholder:"Minutes",class:"nes-input",style:a(F.value)},null,4),[[b,W.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":n[8]||(n[8]=t=>U.value=t),placeholder:"Split (e.g. 2:05)",class:"nes-input",style:a(F.value)},null,4),[[b,U.value]]),h(e("input",{"onUpdate:modelValue":n[9]||(n[9]=t=>B.value=t),type:"number",placeholder:"SPM",class:"nes-input",style:a(Y.value)},null,4),[[b,B.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":n[10]||(n[10]=t=>M.value=t),type:"number",placeholder:"Cal",class:"nes-input",style:a(Y.value)},null,4),[[b,M.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":n[11]||(n[11]=t=>D.value=t),type:"date",class:"nes-input",style:a(F.value)},null,4),[[b,D.value]]),e("button",{class:"nes-btn is-success",style:a(Z.value),onClick:E,disabled:!T.value&&!W.value},"Log",12,nt)],4)],4),s(l).rowingSessions.value.length>0?(o(),i("div",{key:0,style:a($.value)},[e("h3",{style:a(z.value)},"Sessions",4),(o(!0),i(A,null,j(s(l).rowingSessions.value,t=>(o(),i("div",{key:t.id,style:a(ee.value)},[e("span",{style:te},u(t.date),1),t.meters?(o(),i("span",{key:0,style:le},u(t.meters.toLocaleString())+"m",1)):g("",!0),t.minutes?(o(),i("span",{key:1,style:_},u(t.minutes)+"min",1)):g("",!0),t.splitPace?(o(),i("span",{key:2,style:_},u(t.splitPace)+"/500m",1)):g("",!0),t.strokeRate?(o(),i("span",{key:3,style:_},u(t.strokeRate)+"spm",1)):g("",!0),t.calories?(o(),i("span",{key:4,style:_},u(t.calories)+"cal",1)):g("",!0),e("button",{class:"nes-btn is-error",style:ae,onClick:H=>s(l).deleteRowing(t.id)},"X",8,st)],4))),128))],4)):(o(),i("div",{key:1,style:a(O.value)},[...n[16]||(n[16]=[e("p",{class:"nes-text"},"No rowing sessions. Log your first one above.",-1)])],4))])):g("",!0)],4)],4)]}),_:1})}}}),mt=Ae(ot,[["__scopeId","data-v-965b4b19"]]);export{mt as default};
