import{d as C,r,c as F,k as B,a as o,b as t,f as M,e as S,w as A,g as D,F as k,j as _,a5 as R,a7 as U,a6 as q,h as b,t as u,m as E,u as H,I as i,o as l}from"./index-CZ-bGWNd.js";import{_ as K}from"./_plugin-vue_export-helper-DlAUqK2U.js";const O={class:"vault-page"},Q={class:"vault-header"},z={key:0,class:"sync-status"},G={class:"vault-content"},J={class:"vault-sidebar"},W={class:"sidebar-section"},X={class:"notebook-list"},Y=["href"],Z={class:"notebook-name"},ee={class:"sidebar-section"},te={key:0,class:"file-tree"},se={key:1,class:"loading"},ae={class:"sidebar-section"},ne={key:0,class:"search-results"},le=["onClick"],oe={class:"vault-main"},re={key:0,class:"loading-content"},ie={key:1,class:"error-content"},ce=["innerHTML"],de={key:3,class:"welcome-content"},ue={class:"quick-stats"},ve={class:"stat-card"},pe={class:"stat-value"},he={class:"stat-card"},fe={class:"stat-value"},me={class:"recent-updates"},h="http://192.168.0.250:5002",ye=C({__name:"VaultPage",setup(ge){const v=r([]),f=r([]),$=r(""),p=r(""),m=r(!1),c=r(""),d=r(""),y=r([]),N=r(!0),V=F(()=>p.value?`<div class="md-body"><p>${p.value.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/^### (.*)$/gm,"<h3>$1</h3>").replace(/^## (.*)$/gm,"<h2>$1</h2>").replace(/^# (.*)$/gm,"<h1>$1</h1>").replace(/\*\*([^*]+)\*\*/g,"<strong>$1</strong>").replace(/\*([^*]+)\*/g,"<em>$1</em>").replace(/```(\w*)\n([\s\S]*?)```/g,'<pre><code class="language-$1">$2</code></pre>').replace(/`([^`]+)`/g,"<code>$1</code>").replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank">$1</a>').replace(/^- (.*)$/gm,"<li>$1</li>").replace(/\|(.+)\|/g,e=>"<tr>"+e.split("|").filter(a=>a.trim()).map(a=>`<td>${a.trim()}</td>`).join("")+"</tr>").replace(/^---$/gm,"<hr/>").replace(/\n\n/g,"</p><p>")}</p></div>`:""),I=F(()=>{const s=e=>e.reduce((n,a)=>a.type==="file"?n+1:a.children?n+s(a.children):n,0);return s(v.value)});async function P(){try{const e=await(await fetch(`${h}/api/vault/tree`)).json();e.success&&(v.value=e.tree)}catch(s){console.error("Failed to load vault tree:",s)}}async function T(){try{const e=await(await fetch(`${h}/api/vault/notebooks`)).json();e.success&&(f.value=e.notebooks)}catch(s){console.error("Failed to load notebooks:",s)}}async function g(s){$.value=s,m.value=!0,c.value="";try{const n=await(await fetch(`${h}/api/vault/file/${encodeURIComponent(s)}`)).json();n.success?p.value=n.content:c.value=n.error||"Failed to load file"}catch{c.value="Failed to load file"}finally{m.value=!1}}async function j(){if(!(!d.value||d.value.length<2))try{const e=await(await fetch(`${h}/api/vault/search?q=${encodeURIComponent(d.value)}`)).json();e.success&&(y.value=e.results)}catch(s){console.error("Search failed:",s)}}B(()=>{P(),T()});const w=C({name:"FileTreeNode",props:{node:{type:Object,required:!0},selectedPath:{type:String,default:""},depth:{type:Number,default:0}},emits:["select"],setup(s,{emit:e}){const n=r(s.depth<2),a=()=>{s.node.type==="directory"?n.value=!n.value:s.node.extension===".md"&&e("select",s.node.path)};return()=>i("div",{class:"tree-node"},[i("div",{class:["tree-item",{"is-dir":s.node.type==="directory","is-selected":s.selectedPath===s.node.path}],style:{paddingLeft:`${s.depth*12}px`},onClick:a},[s.node.type==="directory"?i("span",{class:"tree-icon"},n.value?"ðŸ“‚":"ðŸ“"):i("span",{class:"tree-icon"},s.node.extension===".md"?"ðŸ“„":"ðŸ“‹"),i("span",{class:"tree-name"},s.node.name)]),s.node.type==="directory"&&n.value&&s.node.children?i("div",{class:"tree-children"},s.node.children.map(x=>i(w,{node:x,selectedPath:s.selectedPath,depth:s.depth+1,onSelect:L=>e("select",L)}))):null])}});return(s,e)=>{const n=D("router-link");return l(),o("div",O,[t("header",Q,[M(n,{to:"/",class:"back-link"},{default:A(()=>[...e[2]||(e[2]=[t("span",null,"â†",-1),b(" Dashboard ",-1)])]),_:1}),e[4]||(e[4]=t("h1",{class:"vault-title"},"Obsidian Vault",-1)),N.value?(l(),o("div",z,[...e[3]||(e[3]=[t("span",{class:"sync-icon"},"ðŸ“š",-1),t("span",{class:"sync-text"},"Auto-sync active",-1)])])):S("",!0)]),t("div",G,[t("aside",J,[t("div",W,[e[6]||(e[6]=t("h3",{class:"sidebar-title"},"Notebooks",-1)),t("div",X,[(l(!0),o(k,null,_(f.value,a=>(l(),o("a",{key:a.filename,href:`http://192.168.0.250:8888/jupyter/notebooks/${a.filename}?token=homelab2026`,target:"_blank",class:"notebook-link"},[e[5]||(e[5]=t("span",{class:"notebook-icon"},"ðŸ““",-1)),t("span",Z,u(a.name),1)],8,Y))),128))])]),t("div",ee,[e[7]||(e[7]=t("h3",{class:"sidebar-title"},"Files",-1)),v.value.length?(l(),o("div",te,[(l(!0),o(k,null,_(v.value,a=>(l(),E(H(w),{key:a.path,node:a,"selected-path":$.value,onSelect:g},null,8,["node","selected-path"]))),128))])):(l(),o("div",se,"Loading..."))]),t("div",ae,[e[8]||(e[8]=t("h3",{class:"sidebar-title"},"Search",-1)),R(t("input",{"onUpdate:modelValue":e[0]||(e[0]=a=>d.value=a),onKeyup:q(j,["enter"]),type:"text",placeholder:"Search vault...",class:"search-input"},null,544),[[U,d.value]]),y.value.length?(l(),o("div",ne,[(l(!0),o(k,null,_(y.value,a=>(l(),o("div",{key:a.path,onClick:x=>g(a.path),class:"search-result"},u(a.name),9,le))),128))])):S("",!0)])]),t("main",oe,[m.value?(l(),o("div",re,[...e[9]||(e[9]=[t("span",{class:"spinner"},"â³",-1),b(" Loading... ",-1)])])):c.value?(l(),o("div",ie,[e[10]||(e[10]=t("span",null,"âŒ",-1)),b(" "+u(c.value),1)])):p.value?(l(),o("div",{key:2,class:"markdown-content",innerHTML:V.value},null,8,ce)):(l(),o("div",de,[e[17]||(e[17]=t("h2",null,"ðŸ“‚ Select a file to view",-1)),e[18]||(e[18]=t("p",null,"Browse the vault using the file tree on the left, or use the search to find content.",-1)),t("div",ue,[t("div",ve,[e[11]||(e[11]=t("span",{class:"stat-icon"},"ðŸ“„",-1)),t("span",pe,u(I.value),1),e[12]||(e[12]=t("span",{class:"stat-label"},"Files",-1))]),t("div",he,[e[13]||(e[13]=t("span",{class:"stat-icon"},"ðŸ““",-1)),t("span",fe,u(f.value.length),1),e[14]||(e[14]=t("span",{class:"stat-label"},"Notebooks",-1))])]),t("div",me,[e[15]||(e[15]=t("h3",null,"Infrastructure Status",-1)),e[16]||(e[16]=t("p",null,"Infrastructure docs are auto-synced every 5 minutes from Proxmox.",-1)),t("button",{onClick:e[1]||(e[1]=a=>g("Homelab/Infrastructure/README.md")),class:"action-btn"}," View Infrastructure â†’ ")])]))])])])}}}),be=K(ye,[["__scopeId","data-v-44ef5419"]]);export{be as default};
