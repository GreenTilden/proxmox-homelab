import{d as k,r as p,k as w,a as s,b as t,e as f,t as g,F as M,j as N,o as a}from"./index-B984DGIg.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const B=k({name:"ContainerMonitor",setup(){const e=p([]),n=p(!0),i=p(null),y=async()=>{try{const o=await fetch("/api/glances/api/v1.3/containers/lxc");if(!o.ok){if(o.status===404){console.warn("Container group '/lxc' not found. No containers to display."),e.value=[];return}throw new Error(`Failed to fetch LXC container list from '/lxc': ${o.statusText}`)}const r=(await o.json()).subcontainers||[];if(r.length===0){console.warn("No subcontainers found under '/lxc'."),e.value=[];return}const b=r.map(async l=>{var h;const c=await fetch(`/api/glances/api/v1.3/containers${l.name}`);if(!c.ok)return console.error(`Could not fetch details for ${l.name}: ${c.statusText}`),null;const u=await c.json(),_=(h=u.stats)==null?void 0:h[u.stats.length-1],m=u.spec;if(!_||!m||!m.memory)return{name:l.name.replace("/lxc/",""),memory_usage:"N/A"};const x=_.memory.usage/1024/1024,d=m.memory.limit/1024/1024,$=d>0?x/d*100:0;return{name:l.name.replace("/lxc/",""),memory_usage:`${x.toFixed(2)} MB / ${d.toFixed(0)} MB (${$.toFixed(1)}%)`}}),C=(await Promise.all(b)).filter(l=>l!==null);e.value=C}catch(o){i.value=o.message,console.error(o)}finally{n.value=!1}};return w(()=>{y()}),{containers:e,loading:n,error:i}}}),D={class:"p-4 sm:p-6 lg:p-8"},L={key:0},j={key:1,class:"text-red-500"},G={key:2,class:"nes-table-responsive"},E={class:"nes-table is-bordered"},P={key:3};function R(e,n,i,y,o,v){return a(),s("div",D,[n[2]||(n[2]=t("h1",{class:"text-2xl font-bold text-gray-900 mb-4"},"Container Monitor",-1)),e.loading?(a(),s("div",L,"Loading...")):f("",!0),e.error?(a(),s("div",j,g(e.error),1)):f("",!0),e.containers.length>0?(a(),s("div",G,[t("table",E,[n[0]||(n[0]=t("thead",null,[t("tr",null,[t("th",null,"Name"),t("th",null,"Memory Usage")])],-1)),t("tbody",null,[(a(!0),s(M,null,N(e.containers,r=>(a(),s("tr",{key:r.name},[t("td",null,g(r.name),1),t("td",null,g(r.memory_usage),1)]))),128))])])])):e.loading?f("",!0):(a(),s("div",P,[...n[1]||(n[1]=[t("p",null,"No LXC containers found.",-1)])]))])}const V=F(B,[["render",R],["__scopeId","data-v-b83e126c"]]);export{V as default};
