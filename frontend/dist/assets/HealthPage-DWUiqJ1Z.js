import{r as y,c as r,d as Ne,q as Ue,o as De,l as Ie,w as ce,e,n as l,g as Ee,h as Pe,t as u,a as o,k as G,s as _e,F as O,f as g,u as s,j,a5 as h,a6 as f,a7 as ye,a8 as He,b as i}from"./index-Cb9bHEfA.js";import{S as Ge}from"./SeasonalThemeProvider-ewS_V3_x.js";import{a as M}from"./apiClient-C3SqeptG.js";import{_ as Oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useTheme-g-avcNHO.js";import"./AtmosphericBackground-DbF0VqY1.js";import"./ScanlineOverlay-Dres_Fmy.js";function je(){const B=y([]),F=y([]),E=y(null),n=y(!1),m=y(null);async function x(){m.value=null;try{E.value=await M("/health/summary")}catch(v){m.value=v.message}}async function w(v){n.value=!0,m.value=null;try{const d=v?`?days=${v}`:"",I=await M(`/health/weight${d}`);B.value=I.entries||[]}catch(d){m.value=d.message}finally{n.value=!1}}async function $(v){n.value=!0,m.value=null;try{const d=v?`?days=${v}`:"",I=await M(`/health/rowing${d}`);F.value=I.entries||[]}catch(d){m.value=d.message}finally{n.value=!1}}async function L(v){m.value=null;try{await M("/health/weight",{method:"POST",body:JSON.stringify(v)}),await w(90),await x()}catch(d){throw m.value=d.message,d}}async function V(v){m.value=null;try{await M("/health/rowing",{method:"POST",body:JSON.stringify(v)}),await $(90),await x()}catch(d){throw m.value=d.message,d}}async function N(v){m.value=null;try{await M(`/health/weight/${v}`,{method:"DELETE"}),B.value=B.value.filter(d=>d.id!==v),await x()}catch(d){m.value=d.message}}async function S(v){m.value=null;try{await M(`/health/rowing/${v}`,{method:"DELETE"}),F.value=F.value.filter(d=>d.id!==v),await x()}catch(d){m.value=d.message}}async function k(){n.value=!0;try{await Promise.all([x(),w(90),$(90)])}finally{n.value=!1}}const U=r(()=>[...B.value].reverse().slice(-30)),z=3,R=r(()=>{var v;return((v=E.value)==null?void 0:v.rowingThisWeek.sessions)||0}),D=r(()=>R.value>=z);return{weightEntries:B,rowingSessions:F,summary:E,isLoading:n,error:m,weightTrend:U,rowingStreakThisWeek:R,rowingOnTrack:D,weeklyRowingGoal:z,init:k,fetchSummary:x,fetchWeight:w,fetchRowing:$,addWeight:L,addRowing:V,deleteWeight:N,deleteRowing:S}}const Ae={style:{flex:"1"}},qe=["onClick"],Xe={class:"tab-emoji"},Ke={class:"tab-label"},Je={key:2},Qe=["title"],Ye={key:3},Ze=["disabled"],et=["onClick"],tt={key:4},lt=["disabled"],at=["onClick"],p="#2d7d46",K="#c4a747",b="#1a2a2a",nt=Ne({__name:"HealthPage",setup(B){var ne;const F=((ne=document.querySelector('link[rel="icon"]'))==null?void 0:ne.getAttribute("href"))||"";function E(c){const a=document.querySelector('link[rel="icon"]');a&&(a.href=`data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>${c}</text></svg>`)}E("ðŸ‹ï¸"),Ue(()=>{const c=document.querySelector('link[rel="icon"]');c&&(c.href=F)});const n=je(),m=y("dashboard"),x=[{id:"dashboard",label:"Dashboard",icon:"ðŸ“Š"},{id:"weight",label:"Weight",icon:"âš–ï¸"},{id:"rowing",label:"Rowing",icon:"ðŸš£"}],w=y(null),$=y("lbs"),L=y(null),V=y(""),N=y(""),S=y(null),k=y(null),U=y(""),z=y(null),R=y(null),D=y(""),v=r(()=>new Date().toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}));De(()=>n.init());async function d(){w.value&&(await n.addWeight({weight:w.value,unit:$.value,date:V.value||void 0,bodyFat:L.value||void 0,notes:N.value||void 0}),w.value=null,L.value=null,V.value="",N.value="")}async function I(){!S.value&&!k.value||(await n.addRowing({meters:S.value||void 0,minutes:k.value||void 0,date:D.value||void 0,splitPace:U.value||void 0,strokeRate:z.value||void 0,calories:R.value||void 0}),S.value=null,k.value=null,U.value="",z.value=null,R.value=null,D.value="")}const J=r(()=>{const c=n.weightTrend.value.map(a=>a.weight);return c.length?Math.min(...c)-2:0}),ge=r(()=>{const c=n.weightTrend.value.map(a=>a.weight);return c.length?Math.max(...c)+2:100}),pe=r(()=>({minHeight:"100vh",padding:"0",margin:"0",position:"relative",zIndex:"2"})),he=r(()=>({display:"flex",alignItems:"center",gap:"var(--space-md)",padding:"var(--space-md) var(--space-lg)",background:`linear-gradient(135deg, ${b}, ${b}dd)`,borderBottom:`4px solid ${p}`,position:"sticky",top:"0",zIndex:"50",backdropFilter:"blur(8px)"})),we=r(()=>({fontSize:"1.1rem",fontWeight:"700",color:K,margin:"0",letterSpacing:"1px"})),fe=r(()=>({fontSize:"0.6rem",color:`${K}99`,marginTop:"0.15rem"})),be=r(()=>({display:"flex",gap:"0.25rem",padding:"0.5rem var(--space-lg)",background:`${b}ee`,borderBottom:`2px solid ${p}66`,overflowX:"auto",backdropFilter:"blur(8px)"})),xe=r(()=>({fontSize:"0.6rem",padding:"0.35rem 0.7rem",whiteSpace:"nowrap",display:"flex",alignItems:"center",gap:"0.3rem"})),Se=r(()=>({padding:"var(--space-lg)",maxWidth:"900px",margin:"0 auto"})),ke=r(()=>({background:"rgba(239, 68, 68, 0.15)",border:"2px solid rgba(239, 68, 68, 0.5)",borderRadius:"4px",padding:"0.5rem 0.75rem",marginBottom:"1rem",color:"#ff6b6b",display:"flex",alignItems:"center",justifyContent:"space-between",fontSize:"0.75rem"})),A=r(()=>({textAlign:"center",padding:"2rem",color:"var(--text-muted)",fontSize:"0.85rem"})),Te={fontSize:"0.75rem",color:"var(--text-muted)"},T=r(()=>({background:`${b}cc`,border:`2px solid ${p}55`,borderRadius:"4px",padding:"0.75rem",marginBottom:"0.75rem",backdropFilter:"blur(4px)"})),W=r(()=>({fontSize:"0.75rem",color:K,margin:"0 0 0.5rem 0",fontWeight:"600",letterSpacing:"0.5px",textTransform:"uppercase"})),We=r(()=>({display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(220px, 1fr))",gap:"0.75rem",marginBottom:"0.75rem"})),q={fontSize:"1.8rem",fontWeight:"700",color:"var(--text-bright)",lineHeight:"1.2"},X={fontSize:"0.7rem",color:"var(--text-muted)",fontWeight:"400"},P={fontSize:"0.6rem",color:"var(--text-muted)",marginTop:"0.25rem"},$e=r(()=>({height:"12px",background:b,border:`2px solid ${p}44`,borderRadius:"2px",overflow:"hidden",marginTop:"0.4rem"})),ze=c=>({height:"100%",width:`${Math.min(100,Math.max(0,c))}%`,background:c>=100?"#22c55e":`linear-gradient(90deg, ${p}, ${p}cc)`,transition:"width 0.3s ease"}),Re=r(()=>({display:"flex",alignItems:"flex-end",gap:"2px",height:"80px",padding:"0.25rem 0"}));function Ce(c,a){return{flex:"1",display:"flex",flexDirection:"column",justifyContent:"flex-end",height:"100%"}}function Me(c){const a=ge.value-J.value;return{height:`${a>0?(c-J.value)/a*100:50}%`,background:p,borderRadius:"1px 1px 0 0",minHeight:"2px",transition:"height 0.3s ease"}}const Be=r(()=>({display:"flex",justifyContent:"space-between",marginTop:"0.15rem"})),Q=r(()=>({display:"flex",gap:"0.4rem",flexWrap:"wrap",alignItems:"center"})),Fe=r(()=>({flex:"1",minWidth:"120px",fontSize:"0.75rem",padding:"0.4rem",background:b,color:"var(--text-bright)",border:`2px solid ${p}66`})),C=r(()=>({width:"100px",fontSize:"0.75rem",padding:"0.4rem",background:b,color:"var(--text-bright)",border:`2px solid ${p}66`})),Y=r(()=>({width:"70px",fontSize:"0.65rem",padding:"0.25rem",background:b,color:"var(--text-bright)",border:`1px solid ${p}66`})),Le=r(()=>({fontSize:"0.65rem",padding:"0.35rem",width:"auto",background:b,color:"var(--text-bright)",border:`2px solid ${p}66`})),Z=r(()=>({fontSize:"0.65rem",padding:"0.35rem 0.7rem",whiteSpace:"nowrap"})),ee=r(()=>({display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.35rem 0",borderBottom:`1px solid ${p}22`,fontSize:"0.7rem"})),te={color:"var(--text-muted)",minWidth:"5rem",fontFamily:"monospace",fontSize:"0.6rem"},le={fontWeight:"700",color:"var(--text-bright)",fontSize:"0.8rem"},_={color:"var(--text-muted)",fontSize:"0.6rem"},Ve={flex:"1",color:"var(--text-muted)",fontSize:"0.6rem",fontStyle:"italic"},ae={padding:"0.1rem 0.35rem",fontSize:"0.55rem",flexShrink:"0"};return(c,a)=>{const se=Pe("router-link");return i(),Ie(Ge,{"enable-scanlines":!0,"enable-particles":!1,"enable-animations":!0},{default:ce(()=>{var ie,oe,re,ue,de,ve,me;return[e("div",{style:l(pe.value)},[e("header",{style:l(he.value)},[Ee(se,{to:"/",style:{"text-decoration":"none",color:"inherit",display:"flex","align-items":"center",gap:"0.5rem"}},{default:ce(()=>[...a[12]||(a[12]=[e("span",{style:{"font-size":"1.5rem"}},"ðŸ‹ï¸",-1)])]),_:1}),e("div",Ae,[e("h1",{class:"nes-text",style:l(we.value)},"Health Tracker",4),e("div",{style:l(fe.value)},u(v.value),5)])],4),e("div",{style:l(be.value)},[(i(),o(O,null,G(x,t=>e("button",{key:t.id,class:_e(["nes-btn",m.value===t.id?"is-primary":""]),style:l(xe.value),onClick:H=>m.value=t.id},[e("span",Xe,u(t.icon),1),e("span",Ke,u(t.label),1)],14,qe)),64))],4),e("main",{style:l(Se.value)},[s(n).error.value?(i(),o("div",{key:0,style:l(ke.value)},[j(u(s(n).error.value)+" ",1),e("button",{class:"nes-btn is-error",style:{"margin-left":"1rem","font-size":"0.6rem"},onClick:a[0]||(a[0]=t=>s(n).error.value=null)},"X")],4)):g("",!0),s(n).isLoading.value&&!s(n).summary.value?(i(),o("div",{key:1,style:l(A.value)},[...a[13]||(a[13]=[e("p",{class:"nes-text"},"Loading health data...",-1)])],4)):m.value==="dashboard"?(i(),o("section",Je,[e("div",{style:l(We.value)},[e("div",{style:l(T.value)},[e("h3",{style:l(W.value)},"Weight",4),(ie=s(n).summary.value)!=null&&ie.latestWeight?(i(),o("div",{key:0,style:q},[j(u(s(n).summary.value.latestWeight.weight)+" ",1),e("span",{style:X},u(s(n).summary.value.latestWeight.unit),1)])):(i(),o("div",{key:1,style:Te},"No entries yet")),(oe=s(n).summary.value)!=null&&oe.latestWeight?(i(),o("div",{key:2,style:P},u(s(n).summary.value.latestWeight.date),1)):g("",!0)],4),e("div",{style:l(T.value)},[e("h3",{style:l(W.value)},"Rowing This Week",4),e("div",{style:q},[j(u(s(n).rowingStreakThisWeek.value)+" ",1),e("span",{style:X},"/ "+u(s(n).weeklyRowingGoal)+" sessions",1)]),e("div",{style:l($e.value)},[e("div",{style:l(ze(Math.round(s(n).rowingStreakThisWeek.value/s(n).weeklyRowingGoal*100)))},null,4)],4),(re=s(n).summary.value)!=null&&re.rowingThisWeek?(i(),o("div",{key:0,style:P},u((s(n).summary.value.rowingThisWeek.totalMeters/1e3).toFixed(1))+"km total ",1)):g("",!0)],4),e("div",{style:l(T.value)},[e("h3",{style:l(W.value)},"Rowing This Month",4),(ue=s(n).summary.value)!=null&&ue.rowingThisMonth?(i(),o("div",{key:0,style:q},[j(u(s(n).summary.value.rowingThisMonth.sessions)+" ",1),e("span",{style:X},"sessions")])):g("",!0),(de=s(n).summary.value)!=null&&de.rowingThisMonth?(i(),o("div",{key:1,style:P},u((s(n).summary.value.rowingThisMonth.totalMeters/1e3).toFixed(1))+"km total ",1)):g("",!0)],4)],4),s(n).weightTrend.value.length>1?(i(),o("div",{key:0,style:l(T.value)},[e("h3",{style:l(W.value)},"Weight Trend (Last 30)",4),e("div",{style:l(Re.value)},[(i(!0),o(O,null,G(s(n).weightTrend.value,(t,H)=>(i(),o("div",{key:t.id||H,style:l(Ce(t.weight,H)),title:`${t.date}: ${t.weight} ${t.unit}`},[e("div",{style:l(Me(t.weight))},null,4)],12,Qe))),128))],4),e("div",{style:l(Be.value)},[e("span",{style:P},u((ve=s(n).weightTrend.value[0])==null?void 0:ve.date),1),e("span",{style:P},u((me=s(n).weightTrend.value[s(n).weightTrend.value.length-1])==null?void 0:me.date),1)],4)],4)):g("",!0)])):m.value==="weight"?(i(),o("section",Ye,[e("div",{style:l(T.value)},[e("h3",{style:l(W.value)},"Log Weight",4),e("div",{style:l(Q.value)},[h(e("input",{"onUpdate:modelValue":a[1]||(a[1]=t=>w.value=t),type:"number",step:"0.1",placeholder:"Weight",class:"nes-input",style:l(C.value),onKeyup:ye(d,["enter"])},null,36),[[f,w.value,void 0,{number:!0}]]),h(e("select",{"onUpdate:modelValue":a[2]||(a[2]=t=>$.value=t),class:"nes-select",style:l(Le.value)},[...a[14]||(a[14]=[e("option",{value:"lbs"},"lbs",-1),e("option",{value:"kg"},"kg",-1)])],4),[[He,$.value]]),h(e("input",{"onUpdate:modelValue":a[3]||(a[3]=t=>L.value=t),type:"number",step:"0.1",placeholder:"Body fat %",class:"nes-input",style:l(C.value)},null,4),[[f,L.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":a[4]||(a[4]=t=>V.value=t),type:"date",class:"nes-input",style:l(C.value)},null,4),[[f,V.value]]),h(e("input",{"onUpdate:modelValue":a[5]||(a[5]=t=>N.value=t),placeholder:"Notes",class:"nes-input",style:l(Fe.value)},null,4),[[f,N.value]]),e("button",{class:"nes-btn is-success",style:l(Z.value),onClick:d,disabled:!w.value},"Log",12,Ze)],4)],4),s(n).weightEntries.value.length>0?(i(),o("div",{key:0,style:l(T.value)},[e("h3",{style:l(W.value)},"History",4),(i(!0),o(O,null,G(s(n).weightEntries.value,t=>(i(),o("div",{key:t.id,style:l(ee.value)},[e("span",{style:te},u(t.date),1),e("span",{style:le},u(t.weight)+" "+u(t.unit),1),t.bodyFat?(i(),o("span",{key:0,style:_},u(t.bodyFat)+"% BF",1)):g("",!0),t.notes?(i(),o("span",{key:1,style:Ve},u(t.notes),1)):g("",!0),e("button",{class:"nes-btn is-error",style:ae,onClick:H=>s(n).deleteWeight(t.id)},"X",8,et)],4))),128))],4)):(i(),o("div",{key:1,style:l(A.value)},[...a[15]||(a[15]=[e("p",{class:"nes-text"},"No weight entries. Log your first one above.",-1)])],4))])):m.value==="rowing"?(i(),o("section",tt,[e("div",{style:l(T.value)},[e("h3",{style:l(W.value)},"Log Rowing Session",4),e("div",{style:l(Q.value)},[h(e("input",{"onUpdate:modelValue":a[6]||(a[6]=t=>S.value=t),type:"number",placeholder:"Meters",class:"nes-input",style:l(C.value),onKeyup:ye(I,["enter"])},null,36),[[f,S.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":a[7]||(a[7]=t=>k.value=t),type:"number",step:"0.1",placeholder:"Minutes",class:"nes-input",style:l(C.value)},null,4),[[f,k.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":a[8]||(a[8]=t=>U.value=t),placeholder:"Split (e.g. 2:05)",class:"nes-input",style:l(C.value)},null,4),[[f,U.value]]),h(e("input",{"onUpdate:modelValue":a[9]||(a[9]=t=>z.value=t),type:"number",placeholder:"SPM",class:"nes-input",style:l(Y.value)},null,4),[[f,z.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":a[10]||(a[10]=t=>R.value=t),type:"number",placeholder:"Cal",class:"nes-input",style:l(Y.value)},null,4),[[f,R.value,void 0,{number:!0}]]),h(e("input",{"onUpdate:modelValue":a[11]||(a[11]=t=>D.value=t),type:"date",class:"nes-input",style:l(C.value)},null,4),[[f,D.value]]),e("button",{class:"nes-btn is-success",style:l(Z.value),onClick:I,disabled:!S.value&&!k.value},"Log",12,lt)],4)],4),s(n).rowingSessions.value.length>0?(i(),o("div",{key:0,style:l(T.value)},[e("h3",{style:l(W.value)},"Sessions",4),(i(!0),o(O,null,G(s(n).rowingSessions.value,t=>(i(),o("div",{key:t.id,style:l(ee.value)},[e("span",{style:te},u(t.date),1),t.meters?(i(),o("span",{key:0,style:le},u(t.meters.toLocaleString())+"m",1)):g("",!0),t.minutes?(i(),o("span",{key:1,style:_},u(t.minutes)+"min",1)):g("",!0),t.splitPace?(i(),o("span",{key:2,style:_},u(t.splitPace)+"/500m",1)):g("",!0),t.strokeRate?(i(),o("span",{key:3,style:_},u(t.strokeRate)+"spm",1)):g("",!0),t.calories?(i(),o("span",{key:4,style:_},u(t.calories)+"cal",1)):g("",!0),e("button",{class:"nes-btn is-error",style:ae,onClick:H=>s(n).deleteRowing(t.id)},"X",8,at)],4))),128))],4)):(i(),o("div",{key:1,style:l(A.value)},[...a[16]||(a[16]=[e("p",{class:"nes-text"},"No rowing sessions. Log your first one above.",-1)])],4))])):g("",!0)],4)],4)]}),_:1})}}}),mt=Oe(nt,[["__scopeId","data-v-965b4b19"]]);export{mt as default};
